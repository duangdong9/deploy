(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{440:function(s,t,a){"use strict";a.r(t);var e=a(18),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"服务器的相关命令-以下均在linux系统中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器的相关命令-以下均在linux系统中"}},[s._v("#")]),s._v(" 服务器的相关命令(以下均在Linux系统中)")]),s._v(" "),a("blockquote",[a("p",[s._v("​\t云服务器的默认的端口号是22；")]),s._v(" "),a("p",[s._v("​\t默认的用户是root （超级权限）")])]),s._v(" "),a("h3",{attrs:{id:"用户的基本配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户的基本配置"}},[s._v("#")]),s._v(" 用户的基本配置")]),s._v(" "),a("ul",[a("li",[s._v("ssh root@公网           -登录")]),s._v(" "),a("li",[s._v("df -h             -查看硬盘的使用情况")]),s._v(" "),a("li",[s._v("adduser qd       - 增加用户")]),s._v(" "),a("li",[s._v("gpasswd -a qd sudo       -升级权限")]),s._v(" "),a("li",[s._v("sudo visudo        -进入配置文件      （修改user privilege     修改成和root一样）  Ctrl+x   shift +y")]),s._v(" "),a("li",[s._v("可以用qd登录")])]),s._v(" "),a("h3",{attrs:{id:"ssh的免密登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh的免密登录"}},[s._v("#")]),s._v(" ssh的免密登录")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("公钥和私钥在用户下的"),a("code",[s._v(".ssh")]),s._v("的文件中")])]),s._v(" "),a("li",[a("p",[s._v("在"),a("code",[s._v(".ssh")]),s._v("文件夹中 (本地)")])]),s._v(" "),a("li",[a("p",[s._v("输入")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v(" ssh-keygen -t rsa -b "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" -C "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qd@163.com"')]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("开启ssh代理 :")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("eval")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("ssh-agent-s"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v("  \n")])])])]),s._v(" "),a("li",[a("p",[s._v("将key加入代理：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ssh-add ~/.ssh/id_rsa\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"服务器中-ssh文件夹中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器中-ssh文件夹中"}},[s._v("#")]),s._v(" 服务器中(.ssh文件夹中)")]),s._v(" "),a("ul",[a("li",[s._v("输入")]),s._v(" "),a("li",[s._v('ssh-keygen -t rsa -b 4096 -C "zhouqd@163.com"')]),s._v(" "),a("li",[s._v('开启ssh代理 :     eval "$(ssh-agent-s)"')]),s._v(" "),a("li",[s._v("将key加入代理：ssh-add ~/.ssh/id_rsa")]),s._v(" "),a("li",[s._v("授权：\t\t\t vi authorized_keys\t\t(wq!)保存")]),s._v(" "),a("li",[s._v("输入内容： 将本地的公钥复制到服务器创建好的公钥文件中")]),s._v(" "),a("li",[s._v("授权:                      chmod 600 authorized_keys")]),s._v(" "),a("li",[s._v("重启服务：            sudo service ssh restart")])]),s._v(" "),a("h3",{attrs:{id:"修改端口号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改端口号"}},[s._v("#")]),s._v(" 修改端口号")]),s._v(" "),a("ul",[a("li",[s._v("进入配置文件：        sudo vi /etc/ssh/sshd_config")]),s._v(" "),a("li",[s._v("修改配置项： Port  （1024-65536）选择")]),s._v(" "),a("li",[s._v("UseDNS:no")]),s._v(" "),a("li",[s._v("PermitRootLogin no")]),s._v(" "),a("li",[s._v("末端增加一行：AllowUsers   qd")]),s._v(" "),a("li",[s._v("保存后重启：  sudo service ssh restart")]),s._v(" "),a("li",[s._v("登录：   ssh -p 39999 qd@公网")])]),s._v(" "),a("h3",{attrs:{id:"安全配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安全配置"}},[s._v("#")]),s._v(" 安全配置")]),s._v(" "),a("ul",[a("li",[s._v("升级ubuntu更新：")]),s._v(" "),a("li",[s._v("sudo apt-get update && sudo apt-get upgrade")]),s._v(" "),a("li",[s._v("sudo iptables -F")]),s._v(" "),a("li",[s._v("sudo vi /etc/iptables.up.rules")]),s._v(" "),a("li",[s._v("编辑：")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("*filter\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#allow all connections")]),s._v("\n-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#allow out traffic")]),s._v("\n-A OUTPUT -j ACCEPT\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#allow http https")]),s._v("\n-A INPUT -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" -j ACCEPT\n-A INPUT -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -j ACCEPT\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#allow ssh port login")]),s._v("\n-A INPUT -p tcp -m state --state NEW --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39999")]),s._v(" -j ACCEPT\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ping")]),s._v("\n-A INPUT -P icmp -m icmp --icmp-type "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" -j ACCEPT\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#log denied calls")]),s._v("\n-A INPUT -m limit --limit "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/min -j LOG --log-prefix "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"iptables denied:"')]),s._v(" --log-level "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#drop")]),s._v("\n-A INPUT -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -i eth0 -m state --state NEW -m recent --set\n\n-A INPUT -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -i eth0 -m state --state NEW -m recent --update --seconds "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" --hitcount "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("150")]),s._v(" -j DROP\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#reject all other inbound")]),s._v("\n-A INPUT -j REJECT\n\n-A FORWARD -j REJECT\n\nCOMMIT\n")])])]),a("h4",{attrs:{id:"告知iptable"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#告知iptable"}},[s._v("#")]),s._v(" 告知IPtable")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("sudo iptables-restore < /etc/iptables.up.rules")])]),s._v(" "),a("li",[a("p",[s._v("激活防火墙")])]),s._v(" "),a("li",[a("p",[s._v("查看状态：sudo ufw status")])]),s._v(" "),a("li",[a("p",[s._v("激活：        sudo ufw enable")])])]),s._v(" "),a("h4",{attrs:{id:"开机自动启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开机自动启动"}},[s._v("#")]),s._v(" 开机自动启动：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("sudo vi /etc/network/if-up.d/iptables")])]),s._v(" "),a("li",[a("p",[s._v("#!/bin/sh")])]),s._v(" "),a("li",[a("p",[s._v("iptables-restore /etc/iptables.up.rules")])]),s._v(" "),a("li",[a("p",[s._v("sudo chmod +x etc/network/if-up.d/iptables")])])]),s._v(" "),a("h4",{attrs:{id:"安装fail2ban"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装fail2ban"}},[s._v("#")]),s._v(" 安装fail2ban:")]),s._v(" "),a("ul",[a("li",[s._v("sudo apt-get install fail2ban")]),s._v(" "),a("li",[s._v("进入修改：sudo vi /etc/fail2ban/jail.conf")]),s._v(" "),a("li",[s._v("查看状态：sudo service fail2ban status")]),s._v(" "),a("li",[s._v("启动：sudo service fail2ban start")]),s._v(" "),a("li",[s._v("关闭：sudo service fail2ban stop")])]),s._v(" "),a("h3",{attrs:{id:"nodejs的环境搭载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nodejs的环境搭载"}},[s._v("#")]),s._v(" nodejs的环境搭载")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("更新ubuntu仓库:")])]),s._v(" "),a("li",[a("p",[s._v("sudo apt-get update")])]),s._v(" "),a("li",[a("p",[s._v("安装所需要的加载（一次安装）")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" openssl build-essential libssl-dev "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\n")])])])])]),s._v(" "),a("blockquote",[a("p",[s._v("在GitHub中找到nvm，wget复制粘贴到命令行回车；安装nvm  ，结束后打开新的窗口登录新的进行操作")])]),s._v(" "),a("h4",{attrs:{id:"安装nodejs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装nodejs"}},[s._v("#")]),s._v(" 安装nodejs:")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("nvm "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" v6.9.5\nnvm use v6.9.5\n指定node的版本\nnvm "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v(" default v6.9.5\n")])])]),a("h4",{attrs:{id:"安装npm-版本低的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装npm-版本低的"}},[s._v("#")]),s._v(" 安装npm(版本低的)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -g "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" fs.inotify.max_user_watches"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("524288")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" -a /etc/sysctl.conf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" sysctl -p\n")])])]),a("ul",[a("li",[a("p",[s._v("安装相关的工具：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i pm2 webpack gulp grunt-cli\n")])])])]),s._v(" "),a("li",[a("p",[s._v("安装nginx")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nginx\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/nginx/conf.d\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" imooc-com-8081.conf\n")])])])]),s._v(" "),a("li",[a("p",[s._v("输入：")])])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("upstream imooc "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tserver "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:8081\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nserver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tlisten "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tserver_name 公网ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tlocation / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tproxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_addr")]),s._v("\n\t\tproxy_set_header X-Forward-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\t\tproxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\tproxy_set_header X-Nginx-Proxy "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\t\tproxy_pass http://imooc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\tproxy_redirect off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("ul",[a("li",[a("p",[s._v("测试配置")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" nginx -t\n")])])])]),s._v(" "),a("li",[a("p",[s._v("重启：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" nginx -s reload\n")])])])])])])}),[],!1,null,null,null);t.default=n.exports}}]);